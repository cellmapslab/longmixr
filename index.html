<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="An adaption of the consensus clustering approach from
    ConsensusClusterPlus for longitudinal data. The longitudinal data is
    clustered with flexible mixture models from flexmix, while the consensus
    matrices are hierarchically clustered as in ConsensusClusterPlus. By using
    the flexibility from flexmix and FactoMineR, one can use mixed data
    types for the clustering.">
<title>Longitudinal Consensus Clustering with flexmix â€¢ longmixr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Longitudinal Consensus Clustering with flexmix">
<meta property="og:description" content="An adaption of the consensus clustering approach from
    ConsensusClusterPlus for longitudinal data. The longitudinal data is
    clustered with flexible mixture models from flexmix, while the consensus
    matrices are hierarchically clustered as in ConsensusClusterPlus. By using
    the flexibility from flexmix and FactoMineR, one can use mixed data
    types for the clustering.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">longmixr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/analysis_workflow.html">Example clustering analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cellmapslab/longmixr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="longmixr">longmixr<a class="anchor" aria-label="anchor" href="#longmixr"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of longmixr is to provide consensus clustering for longitudinal clustering performed with <a href="https://cran.r-project.org/package=flexmix" class="external-link"><code>flexmix</code></a>. It uses the approach from <a href="https://bioconductor.org/packages/release/bioc/html/ConsensusClusterPlus.html" class="external-link"><code>ConsensusClusterPlus</code></a> but replaces the clustering of the longitudinal data with a <code>flexmix</code> model.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install longmixr from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"longmixr"</span><span class="op">)</span></code></pre></div>
<p>You can install the latest version from github with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"cellmapslab/longmixr"</span><span class="op">)</span></code></pre></div>
<p>If you want to render the vignette, use:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"cellmapslab/longmixr"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Please note that for the vignette a lot more dependencies are installed.</p>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>You need a dataset with a column that identifies the subject, a column that denotes the time point of the measurement and variables that you want to model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  patient_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
  visit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">10</span><span class="op">)</span>,
  var_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1.5</span>, length.out <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>,
  var_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1.5</span>, to <span class="op">=</span> <span class="fl">0</span>, length.out <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>In the following approach, the variables <code>var_1</code> and <code>var_2</code> each are modeled as dependent on a smooth function of time, taking the multiple measurements for each subject into account. The assumption is that <code>var_1</code> and <code>var_2</code> represent a multivariate outcome. The modeling is specified in the <code>flexmix</code> drivers and the <code>flexmix_formula</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">flexmix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flexmix/man/FLXMRmgcv.html" class="external-link">FLXMRmgcv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"var_1 ~ ."</span><span class="op">)</span><span class="op">)</span>,
                   <span class="fu">flexmix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flexmix/man/FLXMRmgcv.html" class="external-link">FLXMRmgcv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"var_2 ~ ."</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">clustering</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/longitudinal_consensus_cluster.html">longitudinal_consensus_cluster</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">test_data</span>,
  id_column <span class="op">=</span> <span class="st">"patient_id"</span>,
  max_k <span class="op">=</span> <span class="fl">2</span>,
  reps <span class="op">=</span> <span class="fl">3</span>,
  model_list <span class="op">=</span> <span class="va">model_list</span>,
  flexmix_formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"~s(visit, k = 4) | patient_id"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The results of the clustering can be assessed via several plots. For every specified number of clusters, the consensus matrix and the resulting hierarchical clustering on this matrix is shown. Additionally, the consensus CDF and the delta Area plots give a measure which number of cluster is optimal. The tracking plot gives an overview how the observations are distributed across the different clusters for different numbers of specified clusters. The item (subject) consensus plot shows the average consensus of each subject with all other subjects that belong to one cluster. The cluster consensus plot depicts the average consensus between all members of each cluster.</p>
<p>The above mentioned plots are generated when calling the <code>plot</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">clustering</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="detailed-explanation">Detailed explanation<a class="anchor" aria-label="anchor" href="#detailed-explanation"></a>
</h3>
<p>For a detailed explanation how you can use <code>longmixr</code> to analyze your longitudinal data, check out the <a href="https://cellmapslab.github.io/longmixr/articles/analysis_workflow.html">Example clustering analysis vignette</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="cross-sectional-clustering">Cross-sectional clustering<a class="anchor" aria-label="anchor" href="#cross-sectional-clustering"></a>
</h2>
<p>Additionally, this package provides a wrapper function around the <code>ConsensusClusterPlus</code> function to work with mixed continuous and categorical data (by using the Gower distance):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dc</span> <span class="op">&lt;-</span> <span class="va">mtcars</span>
<span class="co"># scale continuous variables</span>
<span class="va">dc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, <span class="va">scale</span><span class="op">)</span>
<span class="co"># code factor variables</span>
<span class="va">dc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">dc</span><span class="op">)</span>,
            vs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">vs</span><span class="op">)</span>,
            am <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span>,
            gear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">gear</span><span class="op">)</span>,
            carb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">carb</span><span class="op">)</span><span class="op">)</span>
<span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/crosssectional_consensus_cluster.html">crosssectional_consensus_cluster</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">dc</span>,
  reps <span class="op">=</span> <span class="fl">10</span>,
  seed <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="copyright">Copyright<a class="anchor" aria-label="anchor" href="#copyright"></a>
</h2>
<p>The package is based on the code of <a href="https://bioconductor.org/packages/release/bioc/html/ConsensusClusterPlus.html" class="external-link"><code>ConsensusClusterPlus</code></a> (version 1.52.0). For this code the copyright holders are Matt Wilkerson and Peter Waltman. For all subsequent changes the copyright holder is the Max Planck Institute of Psychiatry. The code is licensed under GPL v2.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=longmixr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/cellmapslab/longmixr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/cellmapslab/longmixr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 2)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing longmixr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jonas Hagenberg <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1849-1106" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Matt Wilkerson <br><small class="roles"> Author, copyright holder </small>  </li>
<li>Peter Waltman <br><small class="roles"> Author, copyright holder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/cellmapslab/longmixr/actions" class="external-link"><img src="https://github.com/cellmapslab/longmixr/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=longmixr" class="external-link"><img src="https://www.r-pkg.org/badges/version/longmixr" alt="CRAN status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jonas Hagenberg, Matt Wilkerson, Peter Waltman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
